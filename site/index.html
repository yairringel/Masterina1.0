<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Gyro </title>

</head>


<style>
  body 
  {
	margin: 0px;
	padding: 0px;
	font-size:60px;
	position: fixed;
}
  canvas
  { 
	margin: 0px;
	padding: 0px;
	position: absolute;
	left:0px;
    top:0px;
	
  } 
</style>
 

<body >
	alpha:<span id="alpha"></span><br>
	beta:<span id="beta"></span><br>
	gamma:<span id="gamma"></span><br>
	X:<span id="X"></span><br>
	Y:<span id="Y"></span><br>
	
	<canvas id="myCanvas" style="border:2px solid;z-index: 3; "></canvas> 
	<img src="masterina.png" style="position:absolute;left:2px;z-index: 2;">
	<img src="masterina2.png" style="position:absolute;left:2px;z-index: 1;">
</body>
<script type="text/javascript">


    var canvas = document.getElementById('myCanvas');
    var context = canvas.getContext('2d');
    var initialBeta = 1000;
    var Beta=0;
    var Gamma=0;
    context.canvas.width  = window.innerWidth;//resize canvas to whatever window dimensions are
	context.canvas.height = window.innerHeight;
    var radius = 70;
    context.translate(canvas.width / 2, canvas.height / 2); //put 0,0,0 origin at center of screen instead of upper left corner
    context.beginPath();
    context.arc(0, 0, radius, 0, 2 * Math.PI, false);
    context.fillStyle = 'green';
    context.fill();
    context.lineWidth = 5;
    context.strokeStyle = '#003300';
    context.stroke();  
    var deviceOrientationData ={alpha:0,beta:0,gamma:0};//init with 0 as defaults  
    var x=0;
    var y=0;
    var z=100;


    if (window.DeviceOrientationEvent) 
    {//
    	
    	window.addEventListener("deviceorientation", function () {//gyro
    	
        processGyro(event.alpha, event.beta, event.gamma); 
    	}, true);
    	
	}

	

	function drawCir(xx,yy)
	{
		context.beginPath();
	    context.arc(xx, yy, radius, 0, 2 * Math.PI, false);
	    context.fillStyle = 'green';
	    context.fill();
	    context.lineWidth = 5;
	    context.strokeStyle = '#003300';
	    context.stroke();  
	}



	//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
	//===============================================================================================================================================================================




function processGyro(alpha,beta,gamma)
{ 
	deviceOrientationData.alpha=alpha;
	deviceOrientationData.beta=beta;
	deviceOrientationData.gamma=gamma;
	x,y,z=rotatePointViaGyroEulars(x,y,z);
	drawCir(x,y);
	//note: this code is much simpler but less obvious: function processGyro(event){deviceOrientationData = event;}
	
	document.getElementById("alpha").innerHTML=alpha;
	document.getElementById("beta").innerHTML=beta;
	document.getElementById("gamma").innerHTML =gamma;
	document.getElementById("X").innerHTML =rotatePointViaGyroEulars(x,y,z)[0];
	document.getElementById("Y").innerHTML =rotatePointViaGyroEulars(x,y,z);

	
}



function degToRad(deg)// Degree-to-Radian conversion
{
	 return deg * Math.PI / 180; 
}


function rotatePointViaGyroEulars(a,b,c) //rotates 3d point based on eular angles
{
	var oldX=a;
	var oldY=b;
	var oldZ=c;
	
	//order here is important - it must match the processing order of the device
	
	//rotate about z axis
	var newX = oldX * Math.cos(-degToRad(deviceOrientationData.alpha)) - oldY * Math.sin(-degToRad(deviceOrientationData.alpha));
	var newY = oldY * Math.cos(-degToRad(deviceOrientationData.alpha)) + oldX * Math.sin(-degToRad(deviceOrientationData.alpha));
	
	//rotate about x axis
	oldY=newY;
	newY = oldY * Math.cos(-degToRad(deviceOrientationData.beta)) - oldZ * Math.sin(-degToRad(deviceOrientationData.beta));
	var newZ = oldZ * Math.cos(-degToRad(deviceOrientationData.beta)) + oldY * Math.sin(-degToRad(deviceOrientationData.beta));

	
	//rotate about y axis
	oldZ=newZ;
	oldX=newX;

	newZ = oldZ * Math.cos(-degToRad(deviceOrientationData.gamma)) - oldX * Math.sin(-degToRad(deviceOrientationData.gamma));
	newX = oldX * Math.cos(-degToRad(deviceOrientationData.gamma)) + oldZ * Math.sin(-degToRad(deviceOrientationData.gamma));

	
	return [newX,newY,newZ];
}

//========================================================================================================================================================================
//========================================================================================================================================================================

		
 </script>
</html>